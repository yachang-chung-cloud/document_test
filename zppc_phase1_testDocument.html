<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¼‰å…¥ä¸­... | Aiii.Ai</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&family=Noto+Sans+TC:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root { --aiii-deep-blue: #004B85; --aiii-cyan: #0099CC; --action-teal: #1796B0; --gradient-bg: linear-gradient(180deg, #4BC6E6 0%, #00639B 100%); }
    body { margin: 0; font-family: 'Roboto', 'Noto Sans TC', sans-serif; }
    #auth-shell { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--gradient-bg); z-index: 9999; display: flex; align-items: center; justify-content: center; flex-direction: column; }
    .auth-box { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); padding: 40px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 75, 133, 0.15); text-align: center; max-width: 400px; width: 90%; box-sizing: border-box; }
    .auth-logo { width: 120px; margin-bottom: 24px; }
    .auth-title { font-weight: 500; color: var(--aiii-deep-blue); font-size: 1.5rem; margin-bottom: 8px; }
    .auth-p { font-size: 14px; color: #666; margin-bottom: 24px; line-height: 1.5; }
    .auth-input { width: 100%; padding: 12px 16px; margin-bottom: 15px; border: 1px solid #DDD; border-radius: 8px; font-size: 1rem; text-align: center; box-sizing: border-box; }
    .auth-btn { width: 100%; padding: 12px; background-color: var(--action-teal); color: #fff; border: none; border-radius: 50px; font-size: 1rem; font-weight: 500; cursor: pointer; transition: 0.2s; }
    .auth-msg { margin-top: 15px; font-size: 0.9rem; min-height: 1.2em; color: #666; }
    .auth-msg.error { color: #d32f2f; }
  </style>
</head>
<body>
  <div id="auth-shell">
    <div class="auth-box">
      <img src="https://storage.googleapis.com/aiii-storage-public/aiii/Aiii_logo-02.png" alt="Aiii Logo" class="auth-logo">
      <div class="auth-title" id="page-title">å—ä¿è­·çš„æ–‡ä»¶</div>
      <div id="lock-ui" style="display:none;">
        <p class="auth-p">è«‹è¼¸å…¥é©—è­‰ç¢¼ä»¥è§£é–æ–‡ä»¶å…§å®¹ã€‚</p>
        <input type="password" id="access-code" class="auth-input" placeholder="ACCESS CODE" />
        <button id="btn-verify" class="auth-btn" onclick="verifyCode()">è§£é–æ–‡ä»¶</button>
        <div id="auth-msg" class="auth-msg"></div>
      </div>
      <div id="loading-ui"><p class="auth-p">æ­£åœ¨ç¢ºèªæ–‡ä»¶æ¬Šé™...</p></div>
    </div>
  </div>

  <div id="content-root"></div>

  <template id="secure-content">
    <style>
    /* --- Branding Variables --- */
    :root {
      --sky: #AEE0E8;
      --pale-green: #D9ECD2;
      --light-green: #E4F2E7;
      --ivory: #F5FAF2;
      --dark-teal: #204D4C;
      --accent-teal: #51A099;
      --black: #000000;
      --white: #FFFFFF;
      --warning-bg: #fff8e1; /* æŸ”å’Œçš„é»ƒè‰²èƒŒæ™¯ç”¨æ–¼è­¦ç¤º */
      --warning-border: #ffe082;
      
      --gradient-main: linear-gradient(45deg, var(--sky), var(--light-green));
      --gradient-hover: linear-gradient(45deg, var(--pale-green), var(--ivory));

      --font-header: 'Work Sans', 'Noto Sans TC', sans-serif;
      --font-body: 'Work Sans', 'Noto Sans TC', sans-serif;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: var(--font-body);
      background-color: var(--ivory);
      color: var(--black);
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Helper class for English text styling */
    .en-sub {
      display: block;
      font-size: 0.85em;
      opacity: 0.85;
      font-weight: 400;
      margin-top: 4px;
      line-height: 1.3;
      pointer-events: none; /* è®“é»æ“Šäº‹ä»¶ç©¿é€æ–‡å­—ï¼Œç›´æ¥ä½œç”¨åœ¨æŒ‰éˆ•ä¸Š (é¡å¤–ä¿éšª) */
    }

    /* --- Header --- */
    .header {
      background: var(--white);
      padding: 15px 30px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 3px solid var(--pale-green);
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      flex-shrink: 0;
    }

    .logo img {
      height: 40px;
    }

    .header-title {
      font-family: var(--font-header);
      color: var(--dark-teal);
      font-weight: 700;
      font-size: 1.2rem;
      text-align: right;
    }

    /* --- Main Layout --- */
    .main-container {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    /* --- Sidebar (Main Tabs) --- */
    .sidebar {
      width: 250px;
      background-color: var(--dark-teal);
      color: var(--white);
      display: flex;
      flex-direction: column;
      padding: 20px 0;
      flex-shrink: 0;
    }

    .nav-btn {
      background: transparent;
      border: none;
      color: var(--white);
      padding: 15px 25px;
      text-align: left;
      font-family: var(--font-header);
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s;
      border-left: 4px solid transparent;
      opacity: 0.7;
      width: 100%; /* ç¢ºä¿æŒ‰éˆ•å¡«æ»¿å¯¬åº¦ */
    }

    .nav-btn:hover {
      background-color: rgba(255,255,255,0.1);
      opacity: 1;
    }

    .nav-btn.active {
      background-color: rgba(255,255,255,0.15);
      border-left: 4px solid var(--sky);
      opacity: 1;
      font-weight: bold;
    }

    /* --- Content Area --- */
    .content-area {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      background-color: var(--ivory);
    }

    /* --- Section: Intro --- */
    .intro-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .card {
      background: var(--white);
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 4px 15px rgba(32, 77, 76, 0.08);
      border-top: 5px solid var(--sky);
    }

    h2 {
      font-family: var(--font-header);
      color: var(--dark-teal);
      margin-top: 0;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--pale-green);
    }

    .login-box {
      background: var(--light-green);
      padding: 20px;
      border-radius: 8px;
      margin: 15px 0;
      color: var(--dark-teal);
    }

    ul {
      padding-left: 20px;
    }
    
    li {
      margin-bottom: 8px;
    }

    /* --- Section: Scenarios Layout --- */
    .scenario-wrapper {
      display: flex;
      gap: 20px;
      height: 100%;
    }

    /* Scenario Navigation (Inner Sidebar) */
    .scenario-nav {
      width: 280px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding-right: 10px;
      overflow-y: auto;
    }

    .scenario-btn {
      background: var(--white);
      border: 1px solid var(--pale-green);
      padding: 15px;
      border-radius: 8px;
      text-align: left;
      cursor: pointer;
      transition: 0.3s;
      position: relative;
    }

    .scenario-btn:hover {
      border-color: var(--dark-teal);
      transform: translateX(5px);
    }

    .scenario-btn.active {
      background: var(--gradient-main);
      border-color: transparent;
      color: var(--dark-teal);
      font-weight: bold;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .scenario-btn .code {
      font-size: 0.8rem;
      opacity: 0.7;
      display: block;
      margin-bottom: 4px;
    }

    /* Scenario Detail */
    .scenario-detail {
      flex: 1;
      background: var(--white);
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 15px rgba(32, 77, 76, 0.08);
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    .scenario-header {
      margin-bottom: 10px;
    }
    
    .scenario-header h3 {
      font-family: var(--font-header);
      color: var(--dark-teal);
      font-size: 1.8rem;
      margin: 0 0 10px 0;
    }

    /* Warning Box */
    .warning-box {
      background-color: var(--warning-bg);
      border: 1px solid var(--warning-border);
      color: #b36b00;
      padding: 12px 15px;
      border-radius: 6px;
      margin-bottom: 20px;
      font-size: 0.95rem;
      display: flex;
      align-items: start;
      gap: 10px;
    }
    .warning-box strong {
      color: #9c5b00;
    }

    .step-list {
      counter-reset: step;
      list-style: none;
      padding: 0;
      margin-bottom: 30px;
    }

    .step-list li {
      position: relative;
      padding-left: 40px;
      margin-bottom: 12px;
      color: var(--black);
    }

    .step-list li::before {
      counter-increment: step;
      content: counter(step);
      position: absolute;
      left: 0;
      top: 2px;
      width: 24px;
      height: 24px;
      background-color: var(--sky);
      color: var(--dark-teal);
      border-radius: 50%;
      text-align: center;
      line-height: 24px;
      font-weight: bold;
      font-size: 0.8rem;
    }

    /* Video Container */
    .video-container {
      margin-top: auto;
      background-color: var(--black);
      border-radius: 10px;
      min-height: 300px; 
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--white);
      position: relative;
      overflow: hidden;
    }
    
    video {
      max-width: 100%;
      max-height: 60vh; 
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    /* Utility */
    .hidden { display: none !important; }

    /* RWD */
    @media (max-width: 768px) {
      .main-container { flex-direction: column; overflow-y: auto;}
      .sidebar { width: 100%; flex-direction: row; padding: 0; overflow-x: auto;}
      .nav-btn { flex: 1; text-align: center; padding: 10px; white-space: nowrap; border-left: none; border-bottom: 4px solid transparent; }
      .nav-btn.active { border-left: none; border-bottom: 4px solid var(--sky); }
      
      .scenario-wrapper { flex-direction: column; }
      .scenario-nav { width: 100%; max-height: 150px; }
      .content-area { padding: 15px; }
    }
  </style>
    <!-- Header -->
  <header class="header">
    <div class="logo">
      <img src="https://storage.googleapis.com/aiii-storage-public/zpt/ZPH01.Logo.POS.png" alt="Logo">
    </div>
    <div class="header-title">
      æ¸¬è©¦æ“ä½œæ‰‹å†Š Beta
      <span class="en-sub" style="text-align: right;">Testing Manual Beta</span>
    </div>
  </header>

  <!-- Main Container -->
  <div class="main-container">
    
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
      <!-- ä¿®æ­£ï¼šåŠ å…¥ this åƒæ•¸å‚³é -->
      <button class="nav-btn active" onclick="switchMainTab('instructions', this)">
        1. æ¸¬è©¦èªªæ˜
        <span class="en-sub">Test Instructions</span>
      </button>
      <button class="nav-btn" onclick="switchMainTab('scenarios', this)">
        2. æ¸¬è©¦æƒ…å¢ƒ
        <span class="en-sub">Test Scenarios</span>
      </button>
    </nav>

    <!-- Content Area -->
    <main class="content-area">
      
      <!-- Tab 1: æ¸¬è©¦èªªæ˜ -->
      <div id="tab-instructions" class="intro-container">
        <div class="card">
          <h2>
            æ¸¬è©¦é€£çµèˆ‡ç™»å…¥
            <span class="en-sub">Test Link & Login</span>
          </h2>
          <p>
            æ­¡è¿ä½¿ç”¨ PC+ Outreach ç®¡ç†å¹³å° Beta ç‰ˆï¼Œè«‹ä½¿ç”¨ä»¥ä¸‹è³‡è¨Šç™»å…¥ï¼š<br>
            <span class="en-sub">Welcome to PC+ Outreach Management Platform Beta. Please use the following info to log in:</span>
          </p>
          
          <div class="login-box">
            <strong>æ¸¬è©¦é€£çµï¼š</strong> <span style="font-size:0.9em">(Test Link)</span><br>
            <a href="https://studio--zp-outreach-module-81529-b8a40.us-central1.hosted.app/login" target="_blank" style="color: #204D4C; font-weight: bold;">
              é»æ“Šå‰å¾€æ¸¬è©¦ç’°å¢ƒ<br>
              <span style="font-weight:normal; font-size:0.9em;">Click to visit Test Environment</span>
            </a><br><br>
            <strong>ä¸»ç®¡å¸³è™Ÿè³‡è¨Šï¼š</strong> <span style="font-size:0.9em">(Supervisor Account Info)</span><br>
            â€¢ æ‰‹æ©Ÿè™Ÿç¢¼ (Mobile)ï¼š<code>0911111111</code><br>
            â€¢ OTPé©—è­‰ç¢¼ (OTP)ï¼š<code>123456</code><br>
            â€¢ å¯†ç¢¼ (Password)ï¼š<code>123456</code>
          </div>
        </div>

        <div class="card">
          <h2>
            æ¸¬è©¦é‡é»èˆ‡æ³¨æ„äº‹é …
            <span class="en-sub">Testing Focus & Notices</span>
          </h2>
          <ul>
            <li>
              <strong>æƒ…å¢ƒæ“ä½œï¼š</strong>è«‹åˆ‡æ›è‡³ã€Œæ¸¬è©¦æƒ…å¢ƒã€åˆ†é ï¼Œä¾åºå®Œæˆ A~F çš„æ“ä½œæµç¨‹ã€‚<br>
              <span class="en-sub"><strong>Scenario Ops:</strong> Please switch to the "Test Scenarios" tab and complete steps A~F in order.</span>
            </li>
            <li>
              <strong>åé¥‹æ–¹å¼ï¼š</strong>è‹¥æœ‰ä»»ä½•å»ºè­°ï¼Œè«‹æ–¼ <strong>01/23ï¼ˆäº”ï¼‰æœƒè­°</strong> ä¸Šæå‡ºï¼Œæˆ–åœ¨ LINE ç¾¤çµ„ç•™è¨€ï¼Œåœ˜éšŠå°‡é€é AI é€²è¡Œæ”¶æ•´ã€‚<br>
              <span class="en-sub"><strong>Feedback:</strong> Please provide suggestions in the meeting on 01/23 (Fri) or leave a message in the LINE group.</span>
            </li>
            <li>
              <strong>æ‰‹æ©Ÿæ¸¬è©¦ï¼š</strong>å¹³å°æ”¯æ´ RWDï¼Œè«‹å‹™å¿…å”åŠ©æ¸¬è©¦æ‰‹æ©Ÿä»‹é¢çš„æ“ä½œé«”é©—ã€‚<br>
              <span class="en-sub"><strong>Mobile Test:</strong> The platform supports RWD; please verify the mobile interface experience.</span>
            </li>
            <li>
              <strong>è£œå……èªªæ˜ï¼š</strong>
              <span class="en-sub" style="display:inline;">(Supplementary Notes)</span>
              <ul>
                <li>åˆæ¬¡ç™»å…¥ Dashboard è®€å– Demo è³‡æ–™ç´„éœ€ 3-5 ç§’ï¼Œè«‹è€å¿ƒç­‰å€™ã€‚<br><span class="en-sub">Wait 3-5s for Demo data to load upon first login.</span></li>
                <li>è‹¥æµç¨‹å¡ä½ï¼Œå»ºè­°é‡æ–°æ•´ç†é é¢æˆ–é‡æ–°ç™»å…¥ã€‚<br><span class="en-sub">If stuck, please refresh the page or re-login.</span></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <!-- Tab 2: æ¸¬è©¦æƒ…å¢ƒ (åŒ…å«äºŒç´šå°èˆª) -->
      <div id="tab-scenarios" class="scenario-wrapper hidden">
        
        <!-- å·¦å´æƒ…å¢ƒé¸å–® -->
        <div class="scenario-nav" id="scenario-menu">
          <!-- JS å°‡å‹•æ…‹ç”ŸæˆæŒ‰éˆ• -->
        </div>

        <!-- å³å´æƒ…å¢ƒå…§å®¹ -->
        <div class="scenario-detail">
          <div id="scenario-content">
            <!-- JS å°‡å‹•æ…‹å¡«å…¥å…§å®¹ -->
          </div>
        </div>

      </div>

    </main>
  </div>
    <script>
      
    // --- Data: æ¸¬è©¦æƒ…å¢ƒè³‡æ–™ (åŒ…å«ä¸­è‹±æ–‡ç¿»è­¯) ---
    const scenarios = [
      {
        id: 'A',
        title: 'æ–°ç—…æ‚£æ”¶æ¡ˆèˆ‡å»ºæª”<span class="en-sub">New Patient Enrollment</span>',
        desc: 'æ¨¡æ“¬å€‹ç®¡å¸«åœ¨ç¾å ´æˆ–æ”¶åˆ°è³‡æ–™å¾Œï¼Œå°‡æ–°ç—…æ‚£è³‡æ–™è¼¸å…¥ç³»çµ±ã€‚<br><span class="en-sub">Simulate a Case Manager entering new patient data into the system upon receiving it.</span>',
        steps: [
          'é»æ“Šå·¦å´é¸å–®ã€Œç—…æ‚£ç®¡ç†ã€ã€‚<br><span class="en-sub">Click "Patient Management" on the left menu.</span>',
          'é»æ“Šå³ä¸Šè§’ã€Œæ–°å¢ç—…æ‚£ã€æŒ‰éˆ•ã€‚<br><span class="en-sub">Click the "Add Patient" button on the top right.</span>',
          'å¡«å¯«è³‡æ–™ï¼šé¸æ“‡å°ˆæ¡ˆ (å¦‚ï¼šèˆ’åŠ›å¦¥)ã€é†«å¸« (ç³»çµ±è‡ªå‹•éæ¿¾)ã€è¼¸å…¥å§“å/æ‰‹æ©Ÿ/æ€§åˆ¥ã€é¸æ“‡æ”¶æ¡ˆæ—¥æœŸã€‚<br><span class="en-sub">Fill in data: Select Project, Doctor, Name/Mobile/Gender, and Enrollment Date.</span>',
          'é»æ“Šè™›ç·šå€å¡Šã€Œä¸Šå‚³åŒæ„æ›¸ã€ (æ¸¬è©¦ç”¨å¯é¸ä»»æ„åœ–ç‰‡æˆ–PDF)ã€‚<br><span class="en-sub">Click "Upload Consent Form" (Select any image/PDF for testing).</span>',
          'é»æ“Šã€Œç¢ºå®šæ–°å¢ã€ã€‚<br><span class="en-sub">Click "Confirm Add".</span>',
          'ç¢ºèªåˆ—è¡¨å‡ºç¾æ–°ç—…æ‚£ï¼Œç‹€æ…‹é¡¯ç¤ºç‚ºã€Œå¯©æ ¸ä¸­ã€ã€‚<br><span class="en-sub">Verify the new patient appears in the list with status "Under Review".</span>'
        ],
        videoUrl: 'https://storage.googleapis.com/aiii-storage-public/Jo/pcplus_demo_a.mov',
        warning: 'ç›®å‰ä¸²æ¥ Demo è³‡æ–™åº«ï¼Œé»æ“Šã€Œç¢ºå®šæ–°å¢ã€å¾Œç³»çµ±éœ€ç´„ 1-3 ç§’å¯«å…¥è³‡æ–™ï¼Œè«‹è€å¿ƒç­‰å€™ï¼Œå‹¿é‡è¤‡é»æ“Šã€‚<br><span class="en-sub">Connected to Demo DB. System needs 1-3s to write data after clicking confirm. Please wait.</span>'
      },
      {
        id: 'B',
        title: 'è¦åŠƒç—…æ‚£çš„æ²»ç™‚è¨ˆç•«<span class="en-sub">Treatment Plan Planning</span>',
        desc: 'é‡å°å·²æ”¶æ¡ˆç—…æ‚£ï¼Œæ’å®šæœªä¾†çš„æ²»ç™‚æˆ–é—œæ‡·è¨ˆç•« (Plan)ã€‚<br><span class="en-sub">Schedule future treatment or care plans for enrolled patients.</span>',
        steps: [
          'åœ¨ã€Œç—…æ‚£ç®¡ç†ã€åˆ—è¡¨é»æ“Šä»»ä¸€ç—…æ‚£é€²å…¥å…§é ã€‚<br><span class="en-sub">Click any patient in the list to view details.</span>',
          'åˆ‡æ›è‡³ã€ŒPlanã€åˆ†é ï¼Œé»æ“Šã€Œæ–°å¢ Planã€ã€‚<br><span class="en-sub">Switch to "Plan" tab and click "Add Plan".</span>',
          'ç¢ºèªè¡¨å–®å·²è‡ªå‹•å¸¶å…¥å°ˆæ¡ˆèˆ‡ç—…æ‚£å§“åã€‚<br><span class="en-sub">Verify project and patient name are auto-filled.</span>',
          'é¸æ“‡é¡å‹ (å¦‚ï¼šæ–½æ‰“æé†’)ï¼Œä¸¦è¨­å®šé è¨ˆæ—¥æœŸã€‚<br><span class="en-sub">Select Type (e.g., Injection Reminder) and set Expected Date.</span>',
          '(é¸ç”¨) å‹¾é¸ã€Œé–‹å•Ÿæ‰¹æ¬¡å»ºç«‹ã€ï¼Œè¨­å®šé‡è¤‡é€±æœŸ (å¦‚ï¼šæ¯é€±ä¸€æ¬¡ï¼Œé‡è¤‡ 3 æ¬¡)ã€‚<br><span class="en-sub">(Optional) Check "Batch Create" and set cycle (e.g., Weekly, 3 times).</span>',
          'é»æ“Šã€Œç¢ºèªæ–°å¢ã€ï¼Œä¸¦ç¢ºèªåˆ—è¡¨è³‡æ–™æ›´æ–°ã€‚<br><span class="en-sub">Click "Confirm Add" and verify the list updates.</span>'
        ],
        videoUrl: 'https://storage.googleapis.com/aiii-storage-public/Jo/pcplus_demo_b.mov',
        warning: 'ç›®å‰ä¸²æ¥ Demo è³‡æ–™åº«ï¼Œé»æ“Šã€Œç¢ºèªæ–°å¢ã€å¾Œç³»çµ±éœ€ç´„ 1-3 ç§’å¯«å…¥è³‡æ–™ï¼Œè«‹è€å¿ƒç­‰å€™ï¼Œå‹¿é‡è¤‡é»æ“Šã€‚<br><span class="en-sub">Connected to Demo DB. Please wait 1-3s after confirming.</span>'
      },
      {
        id: 'C',
        title: 'Plan çš„æ’ç¨‹èˆ‡åŸ·è¡Œ<span class="en-sub">Plan Scheduling & Execution</span>',
        desc: 'å°‡è¦åŠƒå¥½çš„è¨ˆç•« (Plan) å¯¦éš›å®‰æ’åˆ°è¡Œäº‹æ›† (Schedule) ä¸Šã€‚<br><span class="en-sub">Assign planned items to the actual Schedule.</span>',
        steps: [
          'é»æ“Šå·¦å´é¸å–®ã€Œå·¥ä½œç¸½è¦½ã€ã€‚<br><span class="en-sub">Click "Work Overview" on the left menu.</span>',
          'åœ¨ Plan åˆ†é æ‰¾åˆ°ç‹€æ…‹ç‚ºã€Œå·²æ’å®šã€çš„é …ç›®ã€‚<br><span class="en-sub">Find items with status "Scheduled" in the Plan tab.</span>',
          'é»æ“Šå³å´æ“ä½œæ¬„çš„ã€Œæ—¥æ›†åœ–ç¤º (å®‰æ’è¡Œç¨‹)ã€ã€‚<br><span class="en-sub">Click the "Calendar Icon" (Schedule) in the action column.</span>',
          'ç¢ºèªè‡ªå‹•å¸¶å…¥çš„è³‡è¨Šï¼Œè¨­å®šã€Œæ™‚æ®µã€(ä¸Šåˆ/ä¸‹åˆ) èˆ‡ã€Œèµ·è¨–æ™‚é–“ã€ã€‚<br><span class="en-sub">Check info, set "Session" (AM/PM) and "Start/End Time".</span>',
          '(è‹¥ç‚ºè¨ªè¦–) é¸æ“‡è¨ªè¦–æ–¹å¼ (é¢å°é¢/é›»è©±)ã€‚<br><span class="en-sub">(If Visit) Select method (In-person/Phone).</span>',
          'é»æ“Šã€Œæ–°å¢è‡³ç­è¡¨ã€ã€‚<br><span class="en-sub">Click "Add to Schedule".</span>'
        ],
        videoUrl: 'https://storage.googleapis.com/aiii-storage-public/Jo/pcplus_demo_c.mov',
        warning: 'ç›®å‰ä¸²æ¥ Demo è³‡æ–™åº«ï¼Œé»æ“Šã€Œæ–°å¢è‡³ç­è¡¨ã€å¾Œç³»çµ±éœ€ç´„ 1-3 ç§’å¯«å…¥è³‡æ–™ï¼Œè«‹è€å¿ƒç­‰å€™ï¼Œå‹¿é‡è¤‡é»æ“Šã€‚<br><span class="en-sub">Connected to Demo DB. Please wait 1-3s after adding to schedule.</span>'
      },
      {
        id: 'D',
        title: 'æŸ¥çœ‹å·¥ä½œç¸½è¦½èˆ‡è¡Œç¨‹<span class="en-sub">Overview & Schedule Check</span>',
        desc: 'ç¢ºèª Dashboard è³‡è¨Šèˆ‡éš±ç¢¼åŠŸèƒ½ã€‚<br><span class="en-sub">Check Dashboard info and Data Masking feature.</span>',
        steps: [
          'é»æ“Šå·¦å´é¸å–®ã€ŒDashboardã€ã€‚<br><span class="en-sub">Click "Dashboard" on the left menu.</span>',
          'æª¢è¦–ã€Œä»Šæ—¥è¡Œç¨‹ã€åˆ†é ï¼Œç¢ºèªå‰›æ‰å®‰æ’çš„è¡Œç¨‹æ˜¯å¦å‡ºç¾ã€‚<br><span class="en-sub">Check "Today\'s Schedule" to see if the item appears.</span>',
          'é»æ“Šå³ä¸Šè§’é–‹é—œã€Œé¡¯ç¤ºå®Œæ•´å§“åã€ï¼Œæ¸¬è©¦ç—…æ‚£å§“åçš„éš±ç¢¼/é¡¯ç¤ºåˆ‡æ›ã€‚<br><span class="en-sub">Toggle "Show Full Name" to test masking/unmasking.</span>',
          'é»æ“Šå·¦å´é¸å–®ã€Œå·¥ä½œç¸½è¦½ã€ã€‚<br><span class="en-sub">Click "Work Overview" on the left menu.</span>',
          'åˆ‡æ›ä¸Šæ–¹åˆ†é  (Plan / Note / Daily Log)ï¼Œç¢ºèªåƒ…é¡¯ç¤ºè‡ªå·±è² è²¬çš„è³‡æ–™ã€‚<br><span class="en-sub">Switch tabs (Plan / Note / Daily Log) to see only your data.</span>'
        ],
        videoUrl: 'https://storage.googleapis.com/aiii-storage-public/Jo/pcplus_demo_d.mov'
      },
      {
        id: 'E',
        title: 'åŸ·è¡Œæœå‹™è¨˜éŒ„ (æ‰“å¡)<span class="en-sub">Service Record (Check-in)</span>',
        desc: 'å®Œæˆè¡Œç¨‹å¾Œï¼Œå¡«å¯«æœå‹™ç´€éŒ„ä¸¦çµæ¡ˆã€‚<br><span class="en-sub">Fill in service record and close the case after completion.</span>',
        steps: [
          'å›åˆ°ã€ŒDashboardã€é¦–é çš„ã€Œä»Šæ—¥è¡Œç¨‹ã€ã€‚<br><span class="en-sub">Go back to "Today\'s Schedule" on Dashboard.</span>',
          'æ‰¾åˆ°ä¸€å€‹ã€Œé§è¨ºæœå‹™ã€æˆ–ã€Œè¨ªè¦–ã€é¡å‹çš„è¡Œç¨‹ã€‚<br><span class="en-sub">Find a "Clinic Service" or "Visit" schedule item.</span>',
          'é»æ“Šã€Œæœå‹™ç´€éŒ„ã€æŒ‰éˆ• (åƒ…ç•¶æ—¥è¡Œç¨‹å¯è¦‹)ã€‚<br><span class="en-sub">Click "Service Record" button (Only visible for today).</span>',
          'å¡«å¯«å¯¦éš›èµ·è¨–æ™‚é–“ã€å‹¾é¸æœå‹™å…§å®¹ã€‚<br><span class="en-sub">Fill actual Start/End time and check service content.</span>',
          'æ³¨æ„ï¼šè‹¥æœ‰é—œè¯ Planï¼Œç¢ºèªä¸‹æ–¹å‡ºç¾ç¶ è‰²å€å¡Šã€Œä¸€ä½µçµæ¡ˆé—œè¯ Planã€ã€‚<br><span class="en-sub">Note: If linked to a Plan, ensure "Close Linked Plan" appears green.</span>',
          'é»æ“Šã€Œå„²å­˜ç´€éŒ„ã€ï¼Œç¢ºèªç‹€æ…‹è®Šæ›´ç‚ºã€Œå·²æœå‹™ç´€éŒ„ã€ã€‚<br><span class="en-sub">Click "Save Record" and verify status changes to "Recorded".</span>'
        ],
        videoUrl: 'https://storage.googleapis.com/aiii-storage-public/Jo/pcplus_demo_e.mov',
        warning: 'ç›®å‰ä¸²æ¥ Demo è³‡æ–™åº«ï¼Œé»æ“Šã€Œå„²å­˜ç´€éŒ„ã€å¾Œç³»çµ±éœ€ç´„ 1-3 ç§’è™•ç†è³‡æ–™æ›´æ–°ï¼Œè«‹è€å¿ƒç­‰å€™ï¼Œå‹¿é‡è¤‡é»æ“Šã€‚<br><span class="en-sub">Connected to Demo DB. Please wait 1-3s after saving.</span>'
      },
      {
        id: 'F',
        title: 'åŸ·è¡Œæœªåˆ°è¨ºæœå‹™è¨˜éŒ„<span class="en-sub">Missed Visit Record</span>',
        desc: 'ç•¶ç—…æ‚£çˆ½ç´„æˆ–è¡Œç¨‹å–æ¶ˆæ™‚çš„ç´€éŒ„æµç¨‹ã€‚<br><span class="en-sub">Process for no-shows or cancelled schedules.</span>',
        steps: [
          'åœ¨ã€ŒDashboardã€ä»Šæ—¥è¡Œç¨‹ä¸­é¸æ“‡ä¸€å€‹å°šæœªåŸ·è¡Œçš„è¡Œç¨‹ã€‚<br><span class="en-sub">Select a pending schedule in "Today\'s Schedule".</span>',
          'é»æ“Šã€Œæœªåˆ°è¨ºæœå‹™ã€æŒ‰éˆ•ã€‚<br><span class="en-sub">Click "Missed Visit" button.</span>',
          'ä¸‹æ‹‰é¸æ“‡åŸå›  (å¦‚ï¼šç—…æ‚£æ‹’çµ•ã€é†«å¸«ä¼‘è¨º)ã€‚<br><span class="en-sub">Select reason (e.g., Patient Refused, Doctor Off).</span>',
          'å¡«å¯«è£œå……èªªæ˜ã€‚<br><span class="en-sub">Fill in supplementary notes.</span>',
          'é»æ“Šã€Œç¢ºèªå›å ±ã€ï¼Œç¢ºèªè©²è¡Œç¨‹ç‹€æ…‹è®Šæ›´ç‚ºã€Œæœªåˆ°è¨ºæœå‹™ã€(ç°è‰²/å¤–æ¡†)ã€‚<br><span class="en-sub">Click "Confirm Report" and verify status changes to "Missed Visit".</span>'
        ],
        videoUrl: 'https://storage.googleapis.com/aiii-storage-public/Jo/pcplus_demo_f.mov',
        warning: 'ç›®å‰ä¸²æ¥ Demo è³‡æ–™åº«ï¼Œé»æ“Šã€Œç¢ºèªå›å ±ã€å¾Œç³»çµ±éœ€ç´„ 1-3 ç§’è™•ç†è³‡æ–™æ›´æ–°ï¼Œè«‹è€å¿ƒç­‰å€™ï¼Œå‹¿é‡è¤‡é»æ“Šã€‚<br><span class="en-sub">Connected to Demo DB. Please wait 1-3s after confirming.</span>'
      }
    ];

    // --- Logic: é é¢åˆ‡æ›èˆ‡åˆå§‹åŒ– ---

    // 1. åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      initScenarioMenu();
      loadScenario(0); // é è¨­è¼‰å…¥ç¬¬ä¸€å€‹æƒ…å¢ƒ
    });

    // 2. åˆ‡æ›ä¸»åˆ†é  (èªªæ˜ vs æƒ…å¢ƒ)
    // ä¿®æ­£ï¼šæ¥æ”¶ btnElement åƒæ•¸ï¼Œç›´æ¥æ“ä½œè©²å…ƒç´ 
    function switchMainTab(tabName, btnElement) {
      // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active æ¨£å¼
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
      
      // å°‡é»æ“Šçš„æŒ‰éˆ•è¨­ç‚º active (å¦‚æœæœ‰çš„è©±)
      if (btnElement) {
        btnElement.classList.add('active');
      }

      // åˆ‡æ›å…§å®¹é¡¯ç¤º
      document.getElementById('tab-instructions').classList.add('hidden');
      document.getElementById('tab-scenarios').classList.add('hidden');
      
      const targetTab = document.getElementById('tab-' + tabName);
      if (targetTab) {
        targetTab.classList.remove('hidden');
      }
    }

    // 3. åˆå§‹åŒ–æƒ…å¢ƒé¸å–®
    function initScenarioMenu() {
      const menuContainer = document.getElementById('scenario-menu');
      scenarios.forEach((s, index) => {
        const btn = document.createElement('div');
        btn.className = 'scenario-btn';
        if(index === 0) btn.classList.add('active');
        // title already includes en-sub span
        btn.innerHTML = `<span class="code">æƒ…å¢ƒ ${s.id}</span>${s.title}`;
        btn.onclick = () => {
          // Remove active class from all
          document.querySelectorAll('.scenario-btn').forEach(b => b.classList.remove('active'));
          // Add to current
          btn.classList.add('active');
          // Load content
          loadScenario(index);
        };
        menuContainer.appendChild(btn);
      });
    }

    // 4. è¼‰å…¥å–®ä¸€æƒ…å¢ƒå…§å®¹
    function loadScenario(index) {
      const s = scenarios[index];
      const container = document.getElementById('scenario-content');
      
      // ç”Ÿæˆæ­¥é©Ÿåˆ—è¡¨ HTML
      const stepsHtml = s.steps.map(step => `<li>${step}</li>`).join('');

      // å½±ç‰‡å€å¡Šé‚è¼¯
      let videoHtml = '';
      if (s.videoUrl) {
        // åˆ¤æ–·æ˜¯å¦ç‚ºç›´æ¥æª”æ¡ˆé€£çµ
        if (s.videoUrl.includes('storage.googleapis.com') || s.videoUrl.endsWith('.mp4') || s.videoUrl.endsWith('.mov')) {
            videoHtml = `
              <video controls autoplay muted playsinline>
                <source src="${s.videoUrl}" type="video/mp4">
                <source src="${s.videoUrl}" type="video/quicktime">
                æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´æ­¤å½±ç‰‡æ¨™ç±¤ï¼Œè«‹å˜—è©¦ä¸‹è¼‰æ’­æ”¾ï¼š<a href="${s.videoUrl}">ä¸‹è¼‰å½±ç‰‡</a><br>
                <span class="en-sub">Browser doesn't support video tag. <a href="${s.videoUrl}">Download Video</a></span>
              </video>`;
        } else {
            // iframe
            videoHtml = `
              <iframe 
                src="${s.videoUrl}" 
                width="100%" 
                height="100%" 
                style="border:none; min-height:400px;" 
                allow="autoplay; fullscreen">
              </iframe>`;
        }
      } else {
        // ç„¡å½±ç‰‡æ™‚çš„ä½”ä½ç¬¦
        videoHtml = `
          <div style="text-align:center;">
            <div style="font-size:3rem; opacity:0.5; margin-bottom:10px;">ğŸ¥</div>
            <div>
              <strong>å¾…è£œä¸Šè¢å¹•éŒ„å½±</strong><br>
              <span class="en-sub">Screen recording pending</span><br>
              ${s.title}
            </div>
          </div>`;
      }

      // ç”Ÿæˆè­¦èª HTML (è‹¥æœ‰)
      let warningHtml = '';
      if (s.warning) {
        warningHtml = `
          <div class="warning-box">
            <div style="font-size: 1.2rem;">âš ï¸</div>
            <div>
              <strong>Demo ç³»çµ±æç¤ºï¼š</strong>${s.warning}
            </div>
          </div>`;
      }

      container.innerHTML = `
        <div class="scenario-header">
          <div style="color: var(--accent-teal); font-weight:bold; margin-bottom:5px;">æƒ…å¢ƒ ${s.id} (Scenario ${s.id})</div>
          <h3>${s.title}</h3>
          <p style="color:#666;">${s.desc}</p>
        </div>
        
        ${warningHtml}

        <ul class="step-list">
          ${stepsHtml}
        </ul>

        <div class="video-container" style="${s.videoUrl ? 'background:black;' : 'background:var(--ivory);'}">
          ${videoHtml}
        </div>
      `;
    }
  
      // è‡ªå‹•è§¸ç™¼åˆå§‹åŒ– (é©ç”¨æ–¼åŒ…å« initScenarioMenu çš„è…³æœ¬)
      if (typeof initScenarioMenu === 'function') initScenarioMenu();
      if (typeof loadScenario === 'function') loadScenario(0);
    </script>
  </template>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbxlFcznIZz98m7lkqo8l5_lDenFTNJi-hQSxQEXFkiIo3s5uFOCIcFsjCNjUKDKbqaOZg/exec";
    const DOC_KEY = "zppc_phase1_testDocument";

    window.onload = function() {
        fetch(GAS_URL + "?key=" + DOC_KEY)
            .then(res => res.json())
            .then(data => {
                document.getElementById('loading-ui').style.display = 'none';
                if (data.status === 'success') {
                    unlockContent(data.title);
                } else {
                    document.getElementById('page-title').innerText = data.title;
                    document.getElementById('lock-ui').style.display = 'block';
                }
            });
    };

    function verifyCode() {
        const code = document.getElementById('access-code').value.trim();
        fetch(GAS_URL + "?key=" + DOC_KEY + "&code=" + code)
            .then(res => res.json())
            .then(data => {
                if (data.status === 'success') {
                    unlockContent(data.title);
                } else {
                    document.getElementById('auth-msg').innerText = "é©—è­‰ç¢¼éŒ¯èª¤";
                    document.getElementById('auth-msg').classList.add('error');
                }
            });
    }

    function unlockContent(title) {
        document.title = title + ' | Aiii.Ai';
        const template = document.getElementById('secure-content');
        const root = document.getElementById('content-root');
        const clone = document.importNode(template.content, true);
        root.appendChild(clone);
        document.getElementById('auth-shell').style.display = 'none';
        
        // åŸ·è¡Œæ³¨å…¥çš„ script
        const scripts = root.getElementsByTagName("script");
        for (let i = 0; i < scripts.length; i++) {
            eval(scripts[i].innerText);
        }
    }
  </script>
</body>
</html>
